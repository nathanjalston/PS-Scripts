$localhost = $env:ComputerName

$sess = New-PSSession -ComputerName (Get-ADComputer -Filter {Name -ne $localhost} |`
Select -ExpandProperty Name)

$drives = Invoke-Command -Session $sess -ScriptBlock {Get-Volume |`
Where {$_.DriveType -eq "Fixed" -and $_.DriveLetter -ne $null}}

Get-PSSession | Remove-PSSession

$drives | Select @{n='ComputerName';e={$_.PSComputerName}}, DriveLetter, DriveType,`
@{n='Size (GB)';e={'{0:N2}' -f ($_.Size / 1GB)}},`
@{n='SizeRemaining (GB)';e={'{0:N2}' -f ($_.SizeRemaining / 1GB)}} |`
Sort ComputerName, DriveLetter | Format-Table -GroupBy ComputerName

ForEach ($drive in $drives)
{
if ($drive.SizeRemaining -ge 100)
{Write-Host $drive.PSComputerName drive $drive.DriveLetter is good.}
else
{Write-Host $drive.PSComputerName drive $drive.DriveLetter is not feeling so good.}
}
